@model IEnumerable<DirectAgents.Domain.Entities.TD.Campaign>
@{
    var today = DateTime.Today;
    var startOfMonth = new DateTime(today.Year, today.Month, 1);
    var lastMonth = startOfMonth.AddMonths(-1);
}

<h2>Campaigns</h2>

<table>
<tr>
    <th></th>
    <th>Advertiser</th>
    <th>Campaign</th>
    <th>ID</th>
    <th>External Accounts</th>
    <th>Platforms</th>
    <th>Stats</th>
</tr>
@foreach (var camp in Model)
{
<tr>
    <td>@Html.ActionLink("Edit", "Edit", new { id = camp.Id })</td>
    <td>@camp.Advertiser.Name</td>
    <td>@camp.Name</td>
    <td>@camp.Id</td>
    <td style="text-align:center">
        @Html.ActionLink(camp.ExtAccounts.Count.ToString(), "Index", "Accounts", new { campId = camp.Id }, null)
        (@Html.ActionLink("stats by ext acct", "Account", "Stats", new { campId = camp.Id }, null))
    </td>
    <td>@string.Join(",", camp.ExtAccounts.Select(a => a.Platform).Distinct().Select(p => p.Name))</td>
    <td>
        @Html.ActionLink("MTD", "MTD", "Stats", new { campId = camp.Id }, null) |
        @Html.ActionLink("Last Month", "MTD", "Stats", new { campId = camp.Id, date = lastMonth.ToShortDateString() }, null)
    </td>
</tr>
}
</table>
