@model DirectAgents.Web.Areas.TD.Models.StatsGaugeVM
@using DirectAgents.Domain.Entities.TD

<h2>Stats Gauge - By ExtAccount</h2>

<table>
<tr>
    <th colspan="3"></th>
    <th colspan="2">Daily</th>
    <th colspan="2">Strategy</th>
    <th colspan="2">Creative</th>
    <th colspan="2">Site</th>
    <th colspan="2">Conv</th>
</tr>
<tr>
    <th>Partner</th>
    <th style="text-align:right">ID</th>
    <th>Ext Account</th>
    <th>Earliest</th>
    <th>Latest</th>
    <th>Earliest</th>
    <th>Latest</th>
    <th>Earliest</th>
    <th>Latest</th>
    <th>Earliest</th>
    <th>Latest</th>
    <th>Earliest</th>
    <th>Latest</th>
</tr>
@foreach (var partner in Model.StatsGauges.OrderBy(p => p.ExtAccount.Platform.Name).GroupBy(p => p.ExtAccount.Platform))
{
<tr style="font-weight:bold;background-color:aquamarine">
    <td colspan="3">@partner.First().ExtAccount.Platform.Name summary for all Ext Accounts:</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Min(p => p.Daily.Earliest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Max(p => p.Daily.Latest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Min(p => p.Strategy.Earliest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Max(p => p.Strategy.Latest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Min(p => p.Creative.Earliest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Max(p => p.Creative.Latest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Min(p => p.Site.Earliest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Max(p => p.Site.Latest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Min(p => p.Conv.Earliest))</td>
    <td style="text-align: right">@String.Format("{0:d}", partner.Max(p => p.Conv.Latest))</td>
</tr>
    foreach (var gauge in partner.OrderBy(g => g.ExtAccount.Name))
    {
<tr>
    <td>@gauge.ExtAccount.Platform.Name</td>
    <td style="text-align:right">@gauge.ExtAccount.Id</td>
    <td>@gauge.ExtAccount.Name</td>
    <td style="text-align:right">@gauge.Daily.EarliestDisp</td>
    <td style="text-align:right">@gauge.Daily.LatestDisp</td>
    <td style="text-align:right">@gauge.Strategy.EarliestDisp</td>
    <td style="text-align:right">@gauge.Strategy.LatestDisp</td>
    <td style="text-align:right">@gauge.Creative.EarliestDisp</td>
    <td style="text-align:right">@gauge.Creative.LatestDisp</td>
    <td style="text-align:right">@gauge.Site.EarliestDisp</td>
    <td style="text-align:right">@gauge.Site.LatestDisp</td>
    <td style="text-align:right">@gauge.Conv.EarliestDisp</td>
    <td style="text-align:right">@gauge.Conv.LatestDisp</td>
</tr>
    }
}
</table>
<br />
@if (!Model.CampaignId.HasValue)
{
    <text>
    Filter:
    @Html.ActionLink("AdRoll", null, new { platform = Platform.Code_AdRoll }) |
    @Html.ActionLink("DBM", null, new { platform = Platform.Code_DBM }) |
    @Html.ActionLink("Facebook", null, new { platform = Platform.Code_FB }) |
    @Html.ActionLink("(show all)", null)
    </text>
    <br /><br />
}