@model ClientPortal.Web.Models.GoalVM
@{
    List<ClientPortal.Data.Contexts.CakeOffer> offers = ViewBag.Offers;
    bool isNewGoal = Model.Id < 0;
}

<div id="editGoalWrapper">
    @using (Ajax.BeginForm(new AjaxOptions { Url = Url.Action("Save"), HttpMethod = "POST", InsertionMode = InsertionMode.Replace, UpdateTargetId = "editGoalWrapper", OnSuccess = "RefreshGoalsAndCloseWindow" }))
    {
        @Html.HiddenFor(model => model.Id)
        @Html.ValidationSummary(true)

        <fieldset>
            <legend>@(isNewGoal ? "Add" : "Edit") Goal</legend>

            <div class="editor-label">
                @Html.LabelFor(model => model.Name)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.Name)
                @Html.ValidationMessageFor(model => model.Name)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.TypeId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(model => model.TypeId, new SelectList(Enum.GetValues(typeof(ClientPortal.Web.Models.GoalTypeEnum))), new { style = "width:auto" })
                @Html.ValidationMessageFor(model => model.TypeId)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.OfferId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(model => model.OfferId, new SelectList(offers, "Offer_Id", "OfferName"))
                @Html.ValidationMessageFor(model => model.OfferId)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.MetricId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(model => model.MetricId, new SelectList(Enum.GetValues(typeof(ClientPortal.Web.Models.MetricEnum))), new { style = "width:auto" })
                @Html.ValidationMessageFor(model => model.MetricId)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.Target)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.Target)
                @Html.ValidationMessageFor(model => model.Target)
            </div>

            <div style="float:left">
                <input type="submit" value="Save" />
            </div>
            <div style="float:right">
                @if (!isNewGoal) {
                <input type="button" value="Delete" onclick="DeleteGoal(@Model.Id, true)" />
                }
            </div>
        </fieldset>
    }
</div>
