using ApiClient.Models.Cake;
using Common;
using System;

namespace ApiClient.Etl.Cake
{
    public class DailySummariesFromWebService : Source<DailySummary>
    {
        static string pids = "31";
//        static string pids = "81,184,241,245,291,345,348,359,410,418,441,463,467,472,477,481,504,547,551,562,572,622,659,697,702,706,725,726,727,753,841,842,899,905,908,944,945,946,959,991,996";
//        static string pids = "1015,1033,1034,1035,1039,1040,1042,1051,1057,1058,1067,1069,1075,1078,1082,1095,1107,1122,1131,1132,1139,1166,1170,1173,1175,1182,1195,1205,1206,1207,1209,1220,1224,1249,1251,1262,1281,1286,1292,1295,1308,1316,1320,1323,1334,1339,1351,1352,1362,1364,1384,1389,1398,1399,1418,1420,1427,1441,1442,1459,1478,1480,1481,1484,1486,1487,1488,1500,1539,1561,1563,1564,1565,1566,1571,1581,1589,1596,1599,1600,1601,1602,1604,1610,1611,1612,1614,1618,1633,1646,1673,1685,1687,1690,1692,1699,1701,1703,1708,1711,1712,1718,1722,1724,1725,1734,1738,1741,1742,1746,1751,1752,1753,1755,1758,1763,1767,1771,1774,1777,1786,1790,1793,1796,1799,1802,1803,1807,1808,1810,1817,1818,1819,1831,1837,1840,1841,1842,1850,1853,1854,1856,1857,1858,1859,1860,1862,1864,1869,1870,1871,1873,1879,1887,1888,1890,1891,1893,1894,1897,1899,1900,1902,1903,1904,1905,1913,1914,1921,1922,1924,1925,1927,1928,1929,1931,1932,1934,1935,1937,1938,1940,1945,1948,1950,1951";
//        static string pids = "11930,11931,11933,11935,11936,11937,11938,11939,11940,11941,11942,11943,11944,11946,11947,11948,11949,11950,11951,11955,11956,11957,11958,11959,11960,11961,11962,11964,11965,11966,11967,11968,11969,11970,11971,11972,11973,11974,11975,11976,11977,11978,11979,11980,11981,11982,11983,11984,11985,11986,11987,11988,11989,11990,11991,11992,11993,11995,11996,11997,11998,11999,12000,12001,12002,12003,12004,12005,12006,12007,12008,12009,12010,12011,12012,12013,12014,12015,12016,12017,12018,12019,12020,12021,12022,12023,12024,12026,12027,12028,12029,12030,12031,12032,12033,12034,12035,12036,12037,12038,12039,12040,12041,12042,12043,12044,12045,12046,12047,12048,12049,12050,12051,12052,12053,12054,12055,12056,12057,12058,12059,12060,12061,12062,12063,12064,12065,12066,12067,12068,12069,12070,12071,12072,12073,12074,12075";
//        static string pids = "30000,30001,30002,30004,30005,30006,30007,30008,30009,30010,30011,30012,30013,30014,30015,30016,30017,30018,30019,30020,30021,30022,30023,30024,30025,30026,30027,30028,30029,30030,30031,30032,30033,30034,30035,30036,30037,30038,30039,30040,30041,30042,30043,30044,30045,30046,30047,30048,30049,30050,30051,30052,30053,30054,30055,30056,30057,30058,30059,30060,30061,30062,30063,30064,30065,30066,30067,30068,30069,30070,30071,30072,30073,30074,30075,30076,30077,30078,30079,30080,30081,30082,30083,30084,30085,30086,30087,30088,30089,30090,30091,30092,30093,30094,30095,30096,30097,30099,30100";

        public override void DoExtract()
        {
            var dateRange = new DateRange(new DateTime(2012, 9, 27), DateTime.Today);

            var pidArray = pids.Split(new char[] { ',' });
            foreach (var pid in pidArray)
            {
                var dailySummaries = CakeWebService.DailySummaries(Int32.Parse(pid), dateRange);
                Logger.Log("{0} Number of DailySummaries: {1}", pid, dailySummaries.Length);
                AddItems(dailySummaries);
            }
            Done = true;
        }
    }
}
