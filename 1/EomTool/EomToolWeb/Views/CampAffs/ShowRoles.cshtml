@model IEnumerable<EomToolWeb.Controllers.AffGroup>
@{
    bool firstAdvRow, firstCampRow;
}

<h3>Show Roles</h3>

Accounting Period:
@Html.Partial("ChooseMonth", (SelectList)ViewBag.ChooseMonthSelectList)
<br />

<table style="border: 1px solid gray">
    <tr>
        <th style="text-align:left">Publisher</th>
        <th style="text-align:left">Advertiser</th>
        <th style="text-align:left">(PID) Campaign</th>
        <th style="text-align:left"></th>
        <th style="text-align:left">Analyst</th>
        <th style="text-align:left">Analyst Mgr</th>
        <th style="text-align:left">Strategist</th>
    </tr>
    @foreach (var affGroup in Model)
    {
        firstAdvRow = true;
        foreach (var advCampGroup in affGroup.AdvCampGroups)
        {
            firstCampRow = true;
            foreach (var camp in advCampGroup.OrderBy(c => c.campaign_name))
            {
                <tr style="background-color: #eee">
                    <td>@(firstAdvRow ? affGroup.AffName : ":")</td>
                    <td>@(firstCampRow ? advCampGroup.Key.name : ":")</td>
                    <td>(@camp.pid) @camp.campaign_name</td>
                    <td>&nbsp;&nbsp;&nbsp;@Html.ActionLink("Edit-", "Edit", new { pid = camp.pid, affid = affGroup.AffId })</td>
                    <td>@(camp.CampAff.Analyst != null ? camp.CampAff.Analyst.name : "")</td>
                    <td>@(camp.CampAff.Analyst != null && camp.CampAff.Analyst.AnalystManager != null ? camp.CampAff.Analyst.AnalystManager.name : "")</td>
                    <td>@(camp.CampAff.Strategist != null ? camp.CampAff.Strategist.name : "")</td>
                </tr>
                firstAdvRow = false;
                firstCampRow = false;
            }
        }
    }
</table>
<br />
List:
@Html.ActionLink("Publishers with activity", "Affiliates", "CampAffs")
